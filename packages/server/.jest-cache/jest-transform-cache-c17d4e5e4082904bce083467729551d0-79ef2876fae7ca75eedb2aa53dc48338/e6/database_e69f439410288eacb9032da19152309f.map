{"file":"C:\\Projects\\Attrition\\packages\\server\\src\\config\\database.ts","mappings":";;;;;;AA2BA,0CAQC;AAwBD,gDAGC;AA9DD,oDAA4B;AAC5B,uDAAqD;AACrD,kEAAyD;AACzD,yCAAwC;AACxC,yCAA0C;AAE1C,gBAAM,CAAC,MAAM,EAAE,CAAC;AAEhB,6BAA6B;AAC7B,MAAM,WAAW,GAAG,OAAO,CAAC,GAAG,CAAC,iBAAQ,CAAC,YAAY,CAAE,CAAC;AACxD,MAAM,WAAW,GAAG,OAAO,CAAC,GAAG,CAAC,iBAAQ,CAAC,iBAAiB,CAAE,CAAC;AAChD,QAAA,QAAQ,GAAG,IAAA,0BAAY,EAAC,WAAW,EAAE,WAAW,CAAC,CAAC;AAE/D,MAAM,YAAY,GAAG,OAAO,CAAC,GAAG,CAAC,iBAAQ,CAAC,QAAQ,CAAC,KAAK,mBAAU,CAAC,UAAU,CAAC;AAC9E,MAAM,aAAa,GAAG,OAAO,CAAC,GAAG,CAAC,iBAAQ,CAAC,QAAQ,CAAC,KAAK,mBAAU,CAAC,WAAW,CAAC;AAEhF;;GAEG;AACU,QAAA,QAAQ,GAAG;IACtB,YAAY;IACZ,aAAa;CACd,CAAC;AAEF;;GAEG;AACI,KAAK,UAAU,eAAe;IACnC,OAAO,CAAC,GAAG,CAAC,2CAA2C,CAAC,CAAC;IACzD,OAAO,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC;IACxC,OAAO,CAAC,GAAG,CAAC,yCAAyC,CAAC,CAAC;IACvD,OAAO,CAAC,GAAG,CAAC,sBAAsB,OAAO,CAAC,GAAG,CAAC,iBAAQ,CAAC,QAAQ,CAAC,IAAI,aAAa,EAAE,CAAC,CAAC;IACrF,OAAO,CAAC,GAAG,CAAC,2CAA2C,CAAC,CAAC;IAEzD,MAAM,wBAAwB,EAAE,CAAC;AACnC,CAAC;AAED;;GAEG;AACH,KAAK,UAAU,wBAAwB;IACrC,IAAI,CAAC;QACH,oCAAoC;QACpC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,gBAAQ,CAAC,IAAI,CAAC,2BAAS,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAEhF,IAAI,KAAK,IAAI,KAAK,CAAC,IAAI,KAAK,UAAU,EAAE,CAAC,CAAC,sCAAsC;YAC9E,MAAM,KAAK,CAAC;QACd,CAAC;QAED,OAAO,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;IACtC,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,CAAC,KAAK,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;QACrD,MAAM,KAAK,CAAC;IACd,CAAC;AACH,CAAC;AAED;;GAEG;AACI,KAAK,UAAU,kBAAkB;IACtC,gDAAgD;IAChD,OAAO,CAAC,GAAG,CAAC,2BAA2B,CAAC,CAAC;AAC3C,CAAC","names":[],"sources":["C:\\Projects\\Attrition\\packages\\server\\src\\config\\database.ts"],"sourcesContent":["import dotenv from 'dotenv';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { DB_TABLES } from '../constants/database-fields';\r\nimport { ENV_VARS } from '@game/shared';\r\nimport { ENV_VALUES } from '@game/shared';\r\n\r\ndotenv.config();\r\n\r\n// Initialize Supabase client\r\nconst supabaseUrl = process.env[ENV_VARS.SUPABASE_URL]!;\r\nconst supabaseKey = process.env[ENV_VARS.SUPABASE_ANON_KEY]!;\r\nexport const supabase = createClient(supabaseUrl, supabaseKey);\r\n\r\nconst isProduction = process.env[ENV_VARS.NODE_ENV] === ENV_VALUES.PRODUCTION;\r\nconst isDevelopment = process.env[ENV_VARS.NODE_ENV] === ENV_VALUES.DEVELOPMENT;\r\n\r\n/**\r\n * Database configuration\r\n */\r\nexport const dbConfig = {\r\n  isProduction,\r\n  isDevelopment,\r\n};\r\n\r\n/**\r\n * Initialize database connection\r\n */\r\nexport async function connectDatabase(): Promise<void> {\r\n  console.log('\\n---------------------------------------');\r\n  console.log('  DATABASE CONFIGURATION');\r\n  console.log('---------------------------------------');\r\n  console.log(`  Environment:     ${process.env[ENV_VARS.NODE_ENV] || 'development'}`);\r\n  console.log('---------------------------------------\\n');\r\n\r\n  await verifyDatabaseConnection();\r\n}\r\n\r\n/**\r\n * Verify database connection\r\n */\r\nasync function verifyDatabaseConnection(): Promise<void> {\r\n  try {\r\n    // Simple query to verify connection\r\n    const { error } = await supabase.from(DB_TABLES.USERS).select('count').limit(1);\r\n\r\n    if (error && error.code !== 'PGRST116') { // PGRST116 = empty table, which is OK\r\n      throw error;\r\n    }\r\n\r\n    console.log('? Database connected');\r\n  } catch (error) {\r\n    console.error('? Database connection error:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Close database connections\r\n */\r\nexport async function disconnectDatabase(): Promise<void> {\r\n  // Database client handles cleanup automatically\r\n  console.log('? Database session closed');\r\n}\r\n\r\n"],"version":3}
{"file":"C:\\Projects\\Attrition\\packages\\server\\src\\config\\ssl.ts","mappings":"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","names":[],"sources":["C:\\Projects\\Attrition\\packages\\server\\src\\config\\ssl.ts"],"sourcesContent":["Ôªøimport fs from 'fs';\nimport path from 'path';\nimport https from 'https';\nimport crypto from 'crypto';\nimport express, { Express } from 'express';\nimport tls from 'tls';\nimport { ENV_VARS, ENV_VALUES } from '@game/shared';\nimport { GAME_CONSTANTS } from '@game/shared';\n\n/**\n * SSL Certificate Configuration Management\n * \n * Handles secure loading and validation of SSL certificates for HTTPS server setup.\n * Supports multiple certificate sources: files, environment variables, and cloud providers.\n * \n * Features:\n * - Multiple certificate source options\n * - Certificate validation and expiry checking  \n * - Secure file permissions verification\n * - Development vs production certificate handling\n * - Comprehensive error handling and logging\n */\n\n/**\n * SSL certificate configuration options\n */\nexport interface SSLConfig {\n  /** SSL private key (PEM format) */\n  key: string;\n  /** SSL certificate (PEM format) */\n  cert: string;\n  /** Certificate chain (optional, PEM format) */\n  ca?: string;\n  /** Passphrase for private key (optional) */\n  passphrase?: string;\n  /** Minimum TLS version (default: 'TLSv1.2') */\n  minVersion?: 'TLSv1.2' | 'TLSv1.3';\n  /** Maximum TLS version (default: 'TLSv1.3') */\n  maxVersion?: 'TLSv1.2' | 'TLSv1.3';\n  /** SSL cipher suites (optional, for custom security profiles) */\n  ciphers?: string;\n  /** Enable certificate validation in development */\n  strictInDev?: boolean;\n  /** ECDH curve preferences for ECDHE cipher suites */\n  ecdhCurve?: string;\n  /** Disable TLS session resumption for enhanced security */\n  disableSessionResumption?: boolean;\n  /** Enable Perfect Forward Secrecy */\n  honorCipherOrder?: boolean;\n  /** DH parameters for DHE cipher suites */\n  dhparam?: string;\n  /** Certificate pinning configuration */\n  certificatePinning?: CertificatePinningConfig;\n  /** TLS session timeout in seconds (default: 300) */\n  sessionTimeout?: number;\n  /** Maximum TLS session cache size */\n  sessionCacheSize?: number;\n  /** Enable OCSP stapling for certificate validation */\n  ocspStapling?: boolean;\n}\n\n/**\n * Certificate pinning configuration for enhanced security\n */\nexport interface CertificatePinningConfig {\n  /** Enable certificate pinning */\n  enabled: boolean;\n  /** SHA-256 hashes of pinned certificates */\n  pinnedCertificates: string[];\n  /** SHA-256 hashes of pinned public keys */\n  pinnedPublicKeys: string[];\n  /** Allow pinning bypass in development */\n  bypassInDevelopment?: boolean;\n  /** Report URI for pin validation failures */\n  reportUri?: string;\n  /** Reporting URL for pin validation failures (alternative property name) */\n  reportingUrl?: string;\n  /** Max age for HPKP header (in seconds) */\n  maxAge?: number;\n  /** Include subdomains in HPKP */\n  includeSubdomains?: boolean;\n  /** Strict mode - reject connections on pin validation failure */\n  strictMode?: boolean;\n}\n\n/**\n * Certificate source configuration\n */\nexport interface CertificateSource {\n  /** Certificate file path */\n  certPath?: string;\n  /** Private key file path */\n  keyPath?: string;\n  /** CA bundle file path */\n  caPath?: string;\n  /** Certificate content from environment variables */\n  certEnvVar?: string;\n  /** Private key content from environment variables */\n  keyEnvVar?: string;\n  /** CA bundle content from environment variables */\n  caEnvVar?: string;\n};\n\n/**\n * Get secure cipher suites with proper preference order\n * Prioritizes TLS 1.3, AEAD ciphers, and perfect forward secrecy\n */\nfunction getSecureCipherSuites(tlsVersion: 'TLSv1.2' | 'TLSv1.3' | 'both' = 'both'): string {\n  // TLS 1.3 cipher suites (preferred) - handled automatically by OpenSSL\n  // These are the only cipher suites available in TLS 1.3:\n  // - TLS_AES_256_GCM_SHA384\n  // - TLS_CHACHA20_POLY1305_SHA256  \n  // - TLS_AES_128_GCM_SHA256\n  // Note: TLS 1.3 ciphers are automatically negotiated and don't need explicit configuration\n\n  // TLS 1.2 cipher suites in strict security preference order\n  const tls12Suites = [\n    // ECDHE with AEAD (Authenticated Encryption with Associated Data) - HIGHEST PRIORITY\n    'ECDHE-ECDSA-AES256-GCM-SHA384',     // ECDSA + AES-256-GCM (strongest)\n    'ECDHE-RSA-AES256-GCM-SHA384',       // RSA + AES-256-GCM\n    'ECDHE-ECDSA-CHACHA20-POLY1305',     // ECDSA + ChaCha20-Poly1305 (mobile optimized)\n    'ECDHE-RSA-CHACHA20-POLY1305',       // RSA + ChaCha20-Poly1305\n    'ECDHE-ECDSA-AES128-GCM-SHA256',     // ECDSA + AES-128-GCM\n    'ECDHE-RSA-AES128-GCM-SHA256',       // RSA + AES-128-GCM\n    \n    // ECDHE with CBC (less preferred due to padding oracle vulnerability potential)\n    'ECDHE-ECDSA-AES256-SHA384',         // ECDSA + AES-256-CBC + SHA-384\n    'ECDHE-RSA-AES256-SHA384',           // RSA + AES-256-CBC + SHA-384\n    'ECDHE-ECDSA-AES128-SHA256',         // ECDSA + AES-128-CBC + SHA-256\n    'ECDHE-RSA-AES128-SHA256',           // RSA + AES-128-CBC + SHA-256\n    \n    // DHE with AEAD (for compatibility with older clients that don't support ECDHE)\n    'DHE-RSA-AES256-GCM-SHA384',         // DHE + AES-256-GCM\n    'DHE-RSA-CHACHA20-POLY1305',         // DHE + ChaCha20-Poly1305\n    'DHE-RSA-AES128-GCM-SHA256',         // DHE + AES-128-GCM\n    \n    // DHE with CBC (least preferred but still secure)\n    'DHE-RSA-AES256-SHA256',             // DHE + AES-256-CBC + SHA-256\n    'DHE-RSA-AES128-SHA256'              // DHE + AES-128-CBC + SHA-256\n  ];\n\n  // Comprehensive list of weak/insecure ciphers to explicitly exclude\n  const excludedCiphers = [\n    // Null encryption/authentication\n    '!NULL',        '!aNULL',       '!eNULL',\n    \n    // Weak/broken encryption algorithms\n    '!EXPORT',      // Export-grade (intentionally weak)\n    '!DES',         // DES (56-bit, broken)\n    '!3DES',        // 3DES (deprecated, SWEET32 attack)\n    '!RC4',         // RC4 (broken stream cipher)\n    '!RC2',         // RC2 (weak)\n    '!SEED',        // SEED (less common, potential issues)\n    '!IDEA',        // IDEA (patent issues, less secure)\n    '!CAMELLIA',    // Camellia (less common, prefer AES)\n    \n    // Weak hash algorithms\n    '!MD5',         // MD5 (broken hash)\n    '!SHA1',        // SHA-1 (deprecated, collision attacks)\n    \n    // Weak key exchange methods\n    '!PSK',         // Pre-shared key (not suitable for general use)\n    '!SRP',         // Secure Remote Password (not needed)\n    '!DSS',         // Digital Signature Standard with DSA (prefer ECDSA/RSA)\n    \n    // Anonymous key exchange (no authentication)\n    '!ADH',         // Anonymous Diffie-Hellman\n    '!AECDH',       // Anonymous Elliptic Curve Diffie-Hellman\n    \n    // Deprecated/insecure modes\n    '!LOW',         // Low security ciphers\n    '!MEDIUM',      // Medium security ciphers (prefer HIGH only)\n    '!EXP',         // Export ciphers\n    \n    // Legacy authentication methods\n    '!KRB5',        // Kerberos (not commonly used for HTTPS)\n    \n    // Ensure no weak elliptic curves (additional security)\n    '!ECDSA+SHA1',  // ECDSA with SHA-1\n    '!RSA+SHA1'     // RSA with SHA-1\n  ];\n\n  // Build cipher string based on TLS version preference\n  let cipherString: string;\n  \n  if (tlsVersion === 'TLSv1.3') {\n    // TLS 1.3 only - OpenSSL handles cipher selection automatically\n    // We still include exclusions for any legacy fallback scenarios\n    cipherString = excludedCiphers.join(':');\n  } else if (tlsVersion === 'TLSv1.2') {\n    // TLS 1.2 only\n    cipherString = [...tls12Suites, ...excludedCiphers].join(':');\n  } else {\n    // Both TLS 1.2 and 1.3 (default)\n    // TLS 1.3 ciphers are automatically preferred by OpenSSL\n    cipherString = [...tls12Suites, ...excludedCiphers].join(':');\n  }\n  \n  return cipherString;\n}\n\n/**\n * Extract SHA-256 hash from certificate for pinning\n * @param certificate PEM certificate content\n * @returns SHA-256 hash of the certificate\n */\nfunction extractCertificateHash(certificate: string): string {\n  try {\n    // Parse certificate and extract DER data\n    const cert = new crypto.X509Certificate(certificate);\n    const derData = cert.raw;\n    \n    // Calculate SHA-256 hash\n    const hash = crypto.createHash('sha256').update(derData).digest('base64');\n    return hash;\n  } catch (error) {\n    throw new Error(`Failed to extract certificate hash: ${error instanceof Error ? error.message : 'unknown error'}`);\n  }\n}\n\n/**\n * Extract SHA-256 hash from public key for pinning\n * @param certificate PEM certificate content\n * @returns SHA-256 hash of the public key\n */\nfunction extractPublicKeyHash(certificate: string): string {\n  try {\n    const cert = new crypto.X509Certificate(certificate);\n    const publicKey = cert.publicKey;\n    \n    // Export public key in DER format\n    const publicKeyDer = publicKey.export({\n      type: 'spki',\n      format: 'der'\n    });\n    \n    // Calculate SHA-256 hash\n    const hash = crypto.createHash('sha256').update(publicKeyDer).digest('base64');\n    return hash;\n  } catch (error) {\n    throw new Error(`Failed to extract public key hash: ${error instanceof Error ? error.message : 'unknown error'}`);\n  }\n}\n\n/**\n * Validate certificate pinning configuration\n * @param config Certificate pinning configuration\n * @param certificate Current certificate to validate against\n * @returns Validation result\n */\nfunction validateCertificatePinning(\n  config: CertificatePinningConfig,\n  certificate: string\n): { isValid: boolean; reason?: string } {\n  if (!config.enabled) {\n    return { isValid: true };\n  }\n  \n  // Allow bypass in development if configured\n  if (config.bypassInDevelopment && process.env[ENV_VARS.NODE_ENV] === ENV_VALUES.DEVELOPMENT) {\n    console.log('üîê Certificate pinning bypassed in development mode');\n    return { isValid: true };\n  }\n  \n  try {\n    // Check certificate hash pinning\n    if (config.pinnedCertificates && config.pinnedCertificates.length > 0) {\n      const currentCertHash = extractCertificateHash(certificate);\n      if (config.pinnedCertificates.includes(currentCertHash)) {\n        console.log('‚úÖ Certificate pinning validation passed (certificate hash match)');\n        return { isValid: true };\n      }\n    }\n    \n    // Check public key hash pinning\n    if (config.pinnedPublicKeys && config.pinnedPublicKeys.length > 0) {\n      const currentPubKeyHash = extractPublicKeyHash(certificate);\n      if (config.pinnedPublicKeys.includes(currentPubKeyHash)) {\n        console.log('‚úÖ Certificate pinning validation passed (public key hash match)');\n        return { isValid: true };\n      }\n    }\n    \n    // No matches found\n    const reason = 'Certificate or public key hash does not match any pinned values';\n    console.error('‚ùå Certificate pinning validation failed:', reason);\n    \n    // Report pin validation failure if configured\n    if (config.reportUri) {\n      reportPinValidationFailure(config.reportUri, certificate, reason);\n    }\n    \n    return { isValid: false, reason };\n    \n  } catch (error) {\n    const reason = `Certificate pinning validation error: ${error instanceof Error ? error.message : 'unknown error'}`;\n    console.error('‚ùå', reason);\n    return { isValid: false, reason };\n  }\n}\n\n/**\n * Validate certificate pin against configuration\n * @param cert Certificate object to validate\n * @param config Certificate pinning configuration\n * @returns Validation result\n */\nfunction validateCertificatePin(cert: any, config: CertificatePinningConfig): { isValid: boolean; error?: string } {\n  try {\n    // Convert certificate to PEM format if needed\n    let certificatePem: string;\n    if (cert && cert.raw) {\n      // Convert DER to PEM format\n      const derBase64 = cert.raw.toString('base64');\n      certificatePem = `-----BEGIN CERTIFICATE-----\\n${derBase64.match(/.{1,64}/g)?.join('\\n') || derBase64}\\n-----END CERTIFICATE-----`;\n    } else if (typeof cert === 'string') {\n      certificatePem = cert;\n    } else {\n      return { isValid: false, error: 'Invalid certificate format for pinning validation' };\n    }\n\n    return validateCertificatePinning(config, certificatePem);\n  } catch (error) {\n    return { isValid: false, error: `Certificate pin validation error: ${error instanceof Error ? error.message : 'Unknown error'}` };\n  }\n}\n\n/**\n * Report certificate pinning failure to configured URL\n * @param reportingUrl URL to report the failure to\n * @param cert Certificate that failed validation\n * @param reason Reason for failure\n * @returns Promise that resolves when report is sent\n */\nasync function reportCertificatePinFailure(reportingUrl: string, cert: any, reason: string): Promise<void> {\n  try {\n    const report = {\n      timestamp: new Date().toISOString(),\n      type: 'certificate-pinning-failure',\n      reason,\n      userAgent: 'Attrition-Server/1.0',\n      // Include certificate details if available\n      certificate: cert && cert.fingerprint ? cert.fingerprint : 'unavailable'\n    };\n    \n    // Log the report locally\n    console.error('üö® Certificate pinning failure report:', JSON.stringify(report));\n    \n    // TODO: Implement actual HTTP POST to reporting URL\n    // For now, just log that we would send the report\n    console.log(`üì° Would send certificate pinning failure report to: ${reportingUrl}`);\n    \n  } catch (error) {\n    console.error('‚ùå Failed to report certificate pinning failure:', error);\n    throw error;\n  }\n}\n\n/**\n * Report certificate pinning validation failure\n * @param reportUri URI to report the failure to\n * @param certificate Certificate that failed validation\n * @param reason Reason for failure\n */\nfunction reportPinValidationFailure(reportUri: string, certificate: string, reason: string) {\n  try {\n    const report = {\n      timestamp: new Date().toISOString(),\n      type: 'certificate-pinning-failure',\n      certificate: extractCertificateHash(certificate),\n      publicKey: extractPublicKeyHash(certificate),\n      reason,\n      userAgent: 'Attrition-Server/1.0'\n    };\n    \n    // Log the report (in a real implementation, this would be sent to the report URI)\n    console.error('üö® Certificate pinning failure report:', JSON.stringify(report));\n    \n    // TODO: Implement actual HTTP POST to report URI\n    // This would typically be done with a non-blocking HTTP request\n    \n  } catch (error) {\n    console.error('‚ùå Failed to report certificate pinning failure:', error);\n  }\n}\n\n/**\n * Generate HPKP (HTTP Public Key Pinning) header\n * @param config Certificate pinning configuration\n * @returns HPKP header value or null if not configured\n */\nexport function generateHPKPHeader(config?: CertificatePinningConfig): string | null {\n  if (!config || !config.enabled || !config.pinnedPublicKeys || config.pinnedPublicKeys.length === 0) {\n    return null;\n  }\n  \n  const pins = config.pinnedPublicKeys.map(hash => `pin-sha256=\"${hash}\"`).join('; ');\n  const maxAge = config.maxAge || 2592000; // Default 30 days\n  const includeSubdomains = config.includeSubdomains ? '; includeSubDomains' : '';\n  const reportUri = config.reportUri ? `; report-uri=\"${config.reportUri}\"` : '';\n  \n  return `${pins}; max-age=${maxAge}${includeSubdomains}${reportUri}`;\n}\n\n/**\n * Validate TLS configuration security\n * @param config SSL configuration to validate\n */\nfunction validateTLSSecurity(config: SSLConfig): { isSecure: boolean; warnings: string[] } {\n  const warnings: string[] = [];\n  let isSecure = true;\n\n  // Check minimum TLS version\n  if (!config.minVersion || config.minVersion < 'TLSv1.2') {\n    warnings.push('TLS version below 1.2 is not secure');\n    isSecure = false;\n  }\n\n  // Check cipher suites\n  if (config.ciphers) {\n    const weakPatterns = ['RC4', 'DES', '3DES', 'MD5', 'NULL', 'EXPORT'];\n    const hasWeakCiphers = weakPatterns.some(pattern => \n      config.ciphers!.toUpperCase().includes(pattern)\n    );\n    if (hasWeakCiphers) {\n      warnings.push('Weak cipher suites detected in configuration');\n      isSecure = false;\n    }\n  }\n\n  // Check for forward secrecy\n  if (config.ciphers && !config.ciphers.includes('ECDHE') && !config.ciphers.includes('DHE')) {\n    warnings.push('No forward secrecy cipher suites configured');\n    isSecure = false;\n  }\n\n  return { isSecure, warnings };\n}\n\n/**\n * Load SSL configuration from various sources\n * @param source Certificate source configuration\n * @returns SSL configuration object\n */\nexport async function loadSSLConfig(source: CertificateSource): Promise<SSLConfig | null> {\n  try {\n    console.log('üîê Loading SSL configuration...');\n\n    // In development, SSL is optional unless explicitly required\n    if (process.env[ENV_VARS.NODE_ENV] === ENV_VALUES.DEVELOPMENT && !process.env[ENV_VARS.FORCE_HTTPS]) {\n      console.log('‚ö†Ô∏è  SSL disabled in development mode');\n      return null;\n    }\n\n    const config: SSLConfig = {\n      key: '',\n      cert: '',\n      minVersion: 'TLSv1.2',\n      maxVersion: 'TLSv1.3',\n      // Modern, secure cipher suites with AEAD and forward secrecy\n      ciphers: getSecureCipherSuites(),\n      // Prefer strong elliptic curves (secp384r1 first for security, prime256v1 for compatibility)\n      ecdhCurve: 'secp384r1:prime256v1:secp521r1',\n      // Enable cipher order preference (server chooses)\n      honorCipherOrder: true,\n      // Session management configuration\n      disableSessionResumption: process.env[ENV_VARS.TLS_DISABLE_SESSION_RESUMPTION] === 'true',\n      sessionTimeout: parseInt(process.env[ENV_VARS.TLS_SESSION_TIMEOUT] || '300', 10), // 5 minutes default\n      sessionCacheSize: parseInt(process.env[ENV_VARS.TLS_SESSION_CACHE_SIZE] || '1024', 10),\n      // OCSP stapling for enhanced certificate validation\n      ocspStapling: process.env[ENV_VARS.TLS_OCSP_STAPLING] !== 'false' // Enabled by default\n    };\n\n    // Load private key\n    config.key = await loadCertificateContent(source.keyPath, source.keyEnvVar, 'SSL_PRIVATE_KEY');\n    if (!config.key) {\n      throw new Error('SSL private key not found');\n    }\n\n    // Load certificate\n    config.cert = await loadCertificateContent(source.certPath, source.certEnvVar, 'SSL_CERTIFICATE');\n    if (!config.cert) {\n      throw new Error('SSL certificate not found');\n    }\n\n    // Load CA bundle (optional)\n    const ca = await loadCertificateContent(source.caPath, source.caEnvVar, 'SSL_CA_BUNDLE');\n    if (ca) {\n      config.ca = ca;\n    }\n\n    // Load passphrase (optional)\n    const passphrase = process.env[ENV_VARS.SSL_KEY_PASSPHRASE];\n    if (passphrase) {\n      config.passphrase = passphrase;\n    }\n\n    // Configure certificate pinning if enabled\n    if (process.env[ENV_VARS.TLS_CERT_PINNING_ENABLED] === 'true') {\n      const pinnedCertificates = process.env[ENV_VARS.TLS_PINNED_CERTIFICATES]?.split(',').map(pin => pin.trim()) || [];\n      const pinnedPublicKeys = process.env[ENV_VARS.TLS_PINNED_PUBLIC_KEYS]?.split(',').map(pin => pin.trim()) || [];\n      \n      if (pinnedCertificates.length > 0 || pinnedPublicKeys.length > 0) {\n        config.certificatePinning = {\n          enabled: true,\n          pinnedCertificates,\n          pinnedPublicKeys,\n          strictMode: process.env[ENV_VARS.TLS_CERT_PINNING_STRICT] === 'true',\n          reportingUrl: process.env[ENV_VARS.TLS_CERT_PINNING_REPORT_URL],\n          maxAge: parseInt(process.env[ENV_VARS.TLS_CERT_PINNING_MAX_AGE] || '2592000', 10), // 30 days default\n          includeSubdomains: process.env[ENV_VARS.TLS_CERT_PINNING_INCLUDE_SUBDOMAINS] === 'true'\n        };\n        \n        console.log('üîí Certificate pinning configured', {\n          pinnedCertificatesCount: pinnedCertificates.length,\n          pinnedPublicKeysCount: pinnedPublicKeys.length,\n          strictMode: config.certificatePinning.strictMode,\n          maxAge: config.certificatePinning.maxAge\n        });\n\n        // Validate pinning configuration\n        const validationResult = validateCertificatePinning(config.certificatePinning, config.cert);\n        if (!validationResult.isValid) {\n          throw new Error(`Invalid certificate pinning configuration: ${validationResult.reason || 'Unknown error'}`);\n        }\n      }\n    }\n\n    // Validate certificates\n    await validateSSLConfig(config);\n\n    // Validate TLS security configuration\n    const tlsValidation = validateTLSSecurity(config);\n    if (!tlsValidation.isSecure) {\n      throw new Error(`TLS configuration is not secure: ${tlsValidation.warnings.join(', ')}`);\n    }\n    \n    if (tlsValidation.warnings.length > 0) {\n      console.warn('‚ö†Ô∏è  TLS configuration warnings:', tlsValidation.warnings);\n    }\n\n    console.log('‚úÖ SSL configuration loaded and validated successfully');\n    return config;\n\n  } catch (error) {\n    const errorMessage = error instanceof Error ? error.message : 'Unknown SSL configuration error';\n    console.error('‚ùå Failed to load SSL configuration:', errorMessage);\n    \n    // In production, SSL errors are fatal\n    if (process.env[ENV_VARS.NODE_ENV] === ENV_VALUES.PRODUCTION) {\n      throw new Error(`SSL configuration required in production: ${errorMessage}`);\n    }\n    \n    // In development, log warning and continue without SSL\n    console.warn('‚ö†Ô∏è  Continuing without SSL in development mode');\n    return null;\n  }\n}\n\n/**\n * Load certificate content from file or environment variable\n * @param filePath Path to certificate file\n * @param envVarName Environment variable name containing certificate\n * @param fallbackEnvVar Fallback environment variable name\n * @returns Certificate content or empty string if not found\n */\nasync function loadCertificateContent(\n  filePath?: string, \n  envVarName?: string, \n  fallbackEnvVar?: string\n): Promise<string> {\n  // Try environment variable first (higher priority)\n  if (envVarName && process.env[envVarName]) {\n    console.log(`üìã Loading certificate from environment variable: ${envVarName}`);\n    return process.env[envVarName]!;\n  }\n\n  // Try fallback environment variable\n  if (fallbackEnvVar && process.env[fallbackEnvVar]) {\n    console.log(`üìã Loading certificate from fallback environment variable: ${fallbackEnvVar}`);\n    return process.env[fallbackEnvVar]!;\n  }\n\n  // Try file path\n  if (filePath) {\n    try {\n      console.log(`üìÅ Loading certificate from file: ${filePath}`);\n      \n      // Validate file exists and has secure permissions\n      await validateCertificateFile(filePath);\n      \n      const content = fs.readFileSync(filePath, 'utf8');\n      \n      if (!content.trim()) {\n        throw new Error(`Certificate file is empty: ${filePath}`);\n      }\n      \n      return content;\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown file error';\n      throw new Error(`Failed to load certificate from file ${filePath}: ${errorMessage}`);\n    }\n  }\n\n  return '';\n}\n\n/**\n * Validate certificate file security\n * @param filePath Path to certificate file\n */\nasync function validateCertificateFile(filePath: string): Promise<void> {\n  try {\n    const stats = fs.statSync(filePath);\n    \n    // Check if file exists and is readable\n    if (!stats.isFile()) {\n      throw new Error('Certificate path is not a file');\n    }\n\n    // Check file permissions (should not be world-readable for private keys)\n    if (filePath.includes('key') || filePath.includes('private')) {\n      const mode = stats.mode & parseInt('777', 8);\n      if (mode & parseInt('044', 8)) {\n        console.warn(`‚ö†Ô∏è  Certificate file has permissive permissions: ${filePath} (${mode.toString(8)})`);\n        if (process.env[ENV_VARS.NODE_ENV] === ENV_VALUES.PRODUCTION) {\n          throw new Error('Private key files should not be world-readable in production');\n        }\n      }\n    }\n\n  } catch (error: any) {\n    if (error && error.code === 'ENOENT') {\n      throw new Error('Certificate file not found');\n    }\n    throw error;\n  }\n}\n\n/**\n * Validate SSL configuration\n * @param config SSL configuration to validate\n */\nasync function validateSSLConfig(config: SSLConfig): Promise<void> {\n  // Basic format validation\n  if (!config.key.includes('BEGIN PRIVATE KEY') && !config.key.includes('BEGIN RSA PRIVATE KEY')) {\n    throw new Error('Invalid private key format (must be PEM)');\n  }\n\n  if (!config.cert.includes('BEGIN CERTIFICATE')) {\n    throw new Error('Invalid certificate format (must be PEM)');\n  }\n\n  // Try to parse certificate for expiry check\n  try {\n    const crypto = await import('crypto');\n    const cert = new crypto.X509Certificate(config.cert);\n    const now = new Date();\n    const validFrom = new Date(cert.validFrom);\n    const validTo = new Date(cert.validTo);\n\n    if (now < validFrom) {\n      throw new Error(`Certificate not yet valid (valid from: ${validFrom.toISOString()})`);\n    }\n\n    if (now > validTo) {\n      throw new Error(`Certificate expired (expired: ${validTo.toISOString()})`);\n    }\n\n    // Warn if certificate expires soon (within 30 days)\n    const daysUntilExpiry = Math.floor((validTo.getTime() - now.getTime()) / (GAME_CONSTANTS.MILLISECONDS_PER_SECOND * GAME_CONSTANTS.SECONDS_PER_MINUTE * 60 * 24));\n    if (daysUntilExpiry < 30) {\n      console.warn(`‚ö†Ô∏è  SSL certificate expires in ${daysUntilExpiry} days (${validTo.toISOString()})`);\n    } else {\n      console.log(`‚úÖ SSL certificate valid until ${validTo.toISOString()} (${daysUntilExpiry} days)`);\n    }\n\n  } catch (error) {\n    console.warn('‚ö†Ô∏è  Could not parse certificate for expiry check:', error);\n  }\n}\n\n/**\n * Create HTTPS server with SSL configuration\n * @param app Express application\n * @param sslConfig SSL configuration\n * @param port Port to listen on\n * @returns HTTPS server instance\n */\nexport function createHttpsServer(app: express.Application, sslConfig: SSLConfig, port: number): https.Server {\n  console.log('üöÄ Creating HTTPS server with TLS hardening...');\n  \n  const serverOptions: https.ServerOptions = {\n    key: sslConfig.key,\n    cert: sslConfig.cert,\n    ca: sslConfig.ca,\n    passphrase: sslConfig.passphrase,\n    \n    // TLS version hardening\n    minVersion: sslConfig.minVersion || 'TLSv1.2',\n    maxVersion: sslConfig.maxVersion || 'TLSv1.3',\n    \n    // Cipher suite configuration\n    ciphers: sslConfig.ciphers,\n    honorCipherOrder: sslConfig.honorCipherOrder !== false, // Default to true\n    \n    // ECDH curve configuration for ECDHE cipher suites\n    ecdhCurve: sslConfig.ecdhCurve || 'prime256v1:secp384r1',\n    \n    // Advanced security hardening\n    secureOptions: (\n      // Disable insecure SSL/TLS versions\n      require('constants').SSL_OP_NO_SSLv2 |\n      require('constants').SSL_OP_NO_SSLv3 |\n      require('constants').SSL_OP_NO_TLSv1 |\n      require('constants').SSL_OP_NO_TLSv1_1 |\n      \n      // Disable TLS compression to prevent CRIME attacks\n      require('constants').SSL_OP_NO_COMPRESSION |\n      \n      // Disable session resumption if configured\n      (sslConfig.disableSessionResumption ? \n        require('constants').SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION : 0) |\n        \n      // Enable single DH use for forward secrecy\n      require('constants').SSL_OP_SINGLE_DH_USE |\n      require('constants').SSL_OP_SINGLE_ECDH_USE\n    ),\n    \n    // Session management configuration\n    sessionTimeout: sslConfig.sessionTimeout,\n    // Note: sessionCacheSize would need to be implemented at the TLS context level\n  };\n\n  const server = https.createServer(serverOptions, app);\n  \n  // Set up certificate pinning validation if enabled\n  if (sslConfig.certificatePinning?.enabled) {\n    server.on('secureConnection', (tlsSocket) => {\n      const cert = tlsSocket.getPeerCertificate(true);\n      if (cert && sslConfig.certificatePinning) {\n        const validationResult = validateCertificatePin(cert, sslConfig.certificatePinning);\n        if (!validationResult.isValid) {\n          console.warn('‚ö†Ô∏è  Certificate pinning validation failed:', validationResult.error);\n          \n          if (sslConfig.certificatePinning.strictMode) {\n            tlsSocket.destroy();\n            return;\n          }\n          \n          // Report pin validation failure\n          if (sslConfig.certificatePinning.reportingUrl) {\n            reportCertificatePinFailure(\n              sslConfig.certificatePinning.reportingUrl,\n              cert,\n              validationResult.error || 'Unknown validation error'\n            ).catch(err => {\n              console.warn('Failed to report certificate pin validation failure:', err);\n            });\n          }\n        }\n      }\n    });\n  }\n  \n  server.on('error', (error) => {\n    console.error('‚ùå HTTPS server error:', error);\n  });\n\n  server.on('listening', () => {\n    console.log(`‚úÖ HTTPS server listening on port ${port}`);\n    console.log(`üîê TLS Configuration:`);\n    console.log(`   - Min Version: ${serverOptions.minVersion}`);\n    console.log(`   - Max Version: ${serverOptions.maxVersion}`);\n    console.log(`   - Cipher Order: ${serverOptions.honorCipherOrder ? 'Server Preference' : 'Client Preference'}`);\n    console.log(`   - ECDH Curves: ${serverOptions.ecdhCurve}`);\n    console.log(`   - Forward Secrecy: ${sslConfig.ciphers?.includes('ECDHE') ? 'Enabled' : 'Check cipher config'}`);\n    console.log(`   - Session Resumption: ${sslConfig.disableSessionResumption ? 'Disabled' : 'Enabled'}`);\n    console.log(`   - Session Timeout: ${sslConfig.sessionTimeout}s`);\n    console.log(`   - Session Cache Size: ${sslConfig.sessionCacheSize}`);\n    console.log(`   - OCSP Stapling: ${sslConfig.ocspStapling ? 'Enabled' : 'Disabled'}`);\n    \n    if (sslConfig.certificatePinning?.enabled) {\n      console.log(`   - Certificate Pinning: Enabled`);\n      console.log(`     * Pinned Certificates: ${sslConfig.certificatePinning.pinnedCertificates.length}`);\n      console.log(`     * Pinned Public Keys: ${sslConfig.certificatePinning.pinnedPublicKeys.length}`);\n      console.log(`     * Strict Mode: ${sslConfig.certificatePinning.strictMode ? 'Enabled' : 'Disabled'}`);\n      console.log(`     * Max Age: ${sslConfig.certificatePinning.maxAge}s`);\n    } else {\n      console.log(`   - Certificate Pinning: Disabled`);\n    }\n  });\n\n  return server;\n}\n\n/**\n * Get SSL configuration from environment and file sources\n * @returns SSL configuration or null if not available\n */\nexport async function getSSLConfigFromEnvironment(): Promise<SSLConfig | null> {\n  const source: CertificateSource = {\n    // File paths from environment variables\n    keyPath: process.env[ENV_VARS.SSL_KEY_PATH],\n    certPath: process.env[ENV_VARS.SSL_CERT_PATH],\n    caPath: process.env[ENV_VARS.SSL_CA_PATH],\n    \n    // Direct certificate content from environment variables\n    keyEnvVar: 'SSL_PRIVATE_KEY',\n    certEnvVar: 'SSL_CERTIFICATE', \n    caEnvVar: 'SSL_CA_BUNDLE'\n  };\n\n  return loadSSLConfig(source);\n}\n\n/**\n * Default SSL configuration for common deployment scenarios\n */\nexport const defaultSSLSources = {\n  // Standard file paths\n  files: {\n    keyPath: '/etc/ssl/private/server.key',\n    certPath: '/etc/ssl/certs/server.crt',\n    caPath: '/etc/ssl/certs/ca-bundle.crt'\n  },\n  \n  // Let's Encrypt paths\n  letsEncrypt: {\n    keyPath: '/etc/letsencrypt/live/domain/privkey.pem',\n    certPath: '/etc/letsencrypt/live/domain/fullchain.pem'\n  },\n  \n  // Development self-signed certificates\n  development: {\n    keyPath: './ssl/dev-key.pem',\n    certPath: './ssl/dev-cert.pem'\n  }\n};\n\nexport default {\n  loadSSLConfig,\n  createHttpsServer,\n  getSSLConfigFromEnvironment,\n  defaultSSLSources\n};\n"],"version":3}
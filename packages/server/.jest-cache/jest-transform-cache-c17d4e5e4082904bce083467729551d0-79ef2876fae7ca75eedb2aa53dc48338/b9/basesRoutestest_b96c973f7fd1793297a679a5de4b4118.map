{"file":"C:\\Projects\\Attrition\\packages\\server\\src\\__tests__\\basesRoutes.test.ts","mappings":"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","names":[],"sources":["C:\\Projects\\Attrition\\packages\\server\\src\\__tests__\\basesRoutes.test.ts"],"sourcesContent":["ï»¿import request from 'supertest';\nimport express from 'express';\nimport basesRoutes from '../routes/game/bases';\nimport { authenticate } from '../middleware/auth';\nimport { supabase } from '../config/supabase';\nimport { HTTP_STATUS, ERROR_MESSAGES } from '../constants/response-formats';\n\n// Mock dependencies\nimport { DB_FIELDS } from '../../../constants/database-fields';\njest.mock('../config/supabase');\njest.mock('../services/empire/EmpireResolutionService');\njest.mock('../middleware/auth');\njest.mock('../services/bases/StatsService');\njest.mock('../services/bases/CapacityService');\n\nconst mockSupabase = supabase as jest.Mocked<typeof supabase>;\nconst mockEmpireResolutionService = EmpireResolutionService as jest.Mocked<typeof EmpireResolutionService>;\nconst mockAuthenticate = authenticate as jest.MockedFunction<typeof authenticate>;\n\n// Test app setup\nconst app = express();\napp.use(express.json());\napp.use('/bases', basesRoutes);\n\n// Mock user for authentication\nconst mockUser = {\n  _id: 'user123',\n  id: 'user123',\n  username: 'testuser'\n};\n\nconst mockEmpire = {\n  id: 'empire123',\n  name: 'Test Empire',\n  territories: ['A00:00:01:01', 'A00:00:01:02']\n};\n\ndescribe('Bases Routes - Territory Migration (FR-16, FR-17, FR-18)', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    \n    // Mock authentication middleware\n    mockAuthenticate.mockImplementation((req: any, res: any, next: any) => {\n      req.user = mockUser;\n      next();\n    });\n\n    // Mock empire resolution\n    mockEmpireResolutionService.resolveEmpireByUserObject.mockResolvedValue(mockEmpire as any);\n  });\n\n  describe('GET /bases - Territory Listing (migrated from v1)', () => {\n    it('should return territories list from colonies table (FR-16)', async () => {\n      // Mock colonies data (preferred source)\n      const mockColonies = [\n        { location_coord: 'A00:00:01:01', name: 'Alpha Base' },\n        { location_coord: 'A00:00:01:02', name: 'Beta Outpost' }\n      ];\n\n      const mockQuery = {\n        select: jest.fn().mockReturnThis(),\n        eq: jest.fn().mockResolvedValue({ data: mockColonies, error: null })\n      };\n      mockSupabase.from.mockReturnValue(mockQuery as any);\n\n      const response = await request(app)\n        .get('/bases')\n        .expect(HTTP_STATUS.OK);\n\n      expect(response.body).toEqual({\n        success: true,\n        data: {\n          territories: [\n            { coord: 'A00:00:01:01', name: 'Alpha Base' },\n            { coord: 'A00:00:01:02', name: 'Beta Outpost' }\n          ]\n        }\n      });\n\n      expect(mockQuery.eq).toHaveBeenCalledWith(DB_FIELDS.BUILDINGS.EMPIRE_ID, 'empire123');\n    });\n\n    it('should fallback to empires.territories when no colonies exist (FR-18)', async () => {\n      // Mock empty colonies, fallback to empire territories\n      const mockEmptyColonies = { data: [], error: null };\n      const mockEmpireData = { data: { territories: ['A00:00:01:01', 'A00:00:01:02'] }, error: null };\n      const mockLocations = { data: [{ coord: 'A00:00:01:01' }, { coord: 'A00:00:01:02' }], error: null };\n\n      const mockColoniesQuery = {\n        select: jest.fn().mockReturnThis(),\n        eq: jest.fn().mockResolvedValue(mockEmptyColonies)\n      };\n\n      const mockEmpireQuery = {\n        select: jest.fn().mockReturnThis(),\n        eq: jest.fn().mockReturnThis(),\n        maybeSingle: jest.fn().mockResolvedValue(mockEmpireData)\n      };\n\n      const mockLocationQuery = {\n        select: jest.fn().mockReturnThis(),\n        in: jest.fn().mockResolvedValue(mockLocations)\n      };\n\n      mockSupabase.from\n        .mockReturnValueOnce(mockColoniesQuery as any)  // colonies query\n        .mockReturnValueOnce(mockEmpireQuery as any)    // empires query  \n        .mockReturnValueOnce(mockLocationQuery as any); // locations query\n\n      const response = await request(app)\n        .get('/bases')\n        .expect(HTTP_STATUS.OK);\n\n      expect(response.body).toEqual({\n        success: true,\n        data: {\n          territories: [\n            { coord: 'A00:00:01:01' },\n            { coord: 'A00:00:01:02' }\n          ]\n        }\n      });\n    });\n\n    it('should return empty array when no territories exist', async () => {\n      const mockEmptyColonies = { data: [], error: null };\n      const mockEmptyEmpire = { data: { territories: [] }, error: null };\n\n      const mockColoniesQuery = {\n        select: jest.fn().mockReturnThis(),\n        eq: jest.fn().mockResolvedValue(mockEmptyColonies)\n      };\n\n      const mockEmpireQuery = {\n        select: jest.fn().mockReturnThis(),\n        eq: jest.fn().mockReturnThis(),\n        maybeSingle: jest.fn().mockResolvedValue(mockEmptyEmpire)\n      };\n\n      mockSupabase.from\n        .mockReturnValueOnce(mockColoniesQuery as any)\n        .mockReturnValueOnce(mockEmpireQuery as any);\n\n      const response = await request(app)\n        .get('/bases')\n        .expect(HTTP_STATUS.OK);\n\n      expect(response.body).toEqual({\n        success: true,\n        data: { territories: [] }\n      });\n    });\n\n    it('should return 404 when empire not found (FR-15)', async () => {\n      mockEmpireResolutionService.resolveEmpireByUserObject.mockResolvedValue(null);\n\n      const response = await request(app)\n        .get('/bases')\n        .expect(HTTP_STATUS.NOT_FOUND);\n\n      expect(response.body).toEqual({\n        success: false,\n        error: ERROR_MESSAGES.EMPIRE_NOT_FOUND\n      });\n    });\n  });\n\n  describe('GET /bases/:coord/stats - Base Statistics (migrated from v1)', () => {\n    it('should return base statistics using StatsService (FR-16)', async () => {\n      const mockStats = {\n        area: 1000,\n        energy: { production: HTTP_STATUS.INTERNAL_SERVER_ERROR, consumption: HTTP_STATUS.OK },\n        population: { current: 1000, capacity: 2000 }\n      };\n\n      // Mock StatsService\n      const mockStatsService = {\n        getBaseStats: jest.fn().mockResolvedValue(mockStats)\n      };\n\n      // Mock dynamic import { HTTP_STATUS, ERROR_MESSAGES } from '../constants/response-formats';\n      jest.doMock('../../../services/bases/StatsService', () => ({\n        StatsService: mockStatsService\n      }));\n\n      const response = await request(app)\n        .get('/bases/A00:00:01:01/stats')\n        .expect(HTTP_STATUS.OK);\n\n      expect(response.body).toEqual({\n        success: true,\n        data: { stats: mockStats }\n      });\n    });\n\n    it('should return 400 when coordinate is missing (FR-15)', async () => {\n      const response = await request(app)\n        .get('/bases//stats')\n        .expect(HTTP_STATUS.BAD_REQUEST);\n\n      expect(response.body).toEqual({\n        success: false,\n        error: ERROR_MESSAGES.COORDINATE_PARAMETER_REQUIRED\n      });\n    });\n\n    it('should return 404 when empire not found (FR-15)', async () => {\n      mockEmpireResolutionService.resolveEmpireByUserObject.mockResolvedValue(null);\n\n      const response = await request(app)\n        .get('/bases/A00:00:01:01/stats')\n        .expect(HTTP_STATUS.NOT_FOUND);\n\n      expect(response.body).toEqual({\n        success: false,\n        error: ERROR_MESSAGES.EMPIRE_NOT_FOUND\n      });\n    });\n  });\n\n  describe('GET /bases/:coord/capacities - Base Capacities (migrated from v1)', () => {\n    it('should return base capacities using CapacityService (FR-16)', async () => {\n      const mockCapacities = {\n        construction: { value: 100, unit: 'credits/hour' },\n        production: { value: 50, unit: 'units/hour' },\n        research: { value: 25, unit: 'points/hour' }\n      };\n\n      // Mock CapacityService\n      const mockCapacityService = {\n        getBaseCapacities: jest.fn().mockResolvedValue(mockCapacities)\n      };\n\n      // Mock dynamic import { HTTP_STATUS, ERROR_MESSAGES } from '../constants/response-formats';\n      jest.doMock('../../../services/bases/CapacityService', () => ({\n        CapacityService: mockCapacityService\n      }));\n\n      const response = await request(app)\n        .get('/bases/A00:00:01:01/capacities')\n        .expect(HTTP_STATUS.OK);\n\n      expect(response.body).toEqual({\n        success: true,\n        data: mockCapacities\n      });\n    });\n\n    it('should handle coordinate validation (FR-15)', async () => {\n      const response = await request(app)\n        .get('/bases//capacities')\n        .expect(HTTP_STATUS.BAD_REQUEST);\n\n      expect(response.body).toEqual({\n        success: false,\n        error: ERROR_MESSAGES.COORDINATE_PARAMETER_REQUIRED\n      });\n    });\n  });\n\n  describe('GET /bases/:coord/combined-stats - Combined Stats (migrated from v1)', () => {\n    it('should return combined stats and capacities (FR-16)', async () => {\n      const mockStats = { area: 1000, energy: HTTP_STATUS.INTERNAL_SERVER_ERROR };\n      const mockCapacities = { construction: 100, production: 50 };\n\n      // Mock both services\n      const mockStatsService = {\n        getBaseStats: jest.fn().mockResolvedValue(mockStats)\n      };\n      const mockCapacityService = {\n        getBaseCapacities: jest.fn().mockResolvedValue(mockCapacities)\n      };\n\n      jest.doMock('../../../services/bases/StatsService', () => ({\n        StatsService: mockStatsService\n      }));\n      jest.doMock('../../../services/bases/CapacityService', () => ({\n        CapacityService: mockCapacityService\n      }));\n\n      const response = await request(app)\n        .get('/bases/A00:00:01:01/combined-stats')\n        .expect(HTTP_STATUS.OK);\n\n      expect(response.body).toEqual({\n        success: true,\n        data: {\n          coord: 'A00:00:01:01',\n          stats: mockStats,\n          capacities: mockCapacities\n        },\n        message: 'Base stats loaded'\n      });\n    });\n\n    it('should make parallel calls to both services for efficiency', async () => {\n      const mockStatsService = {\n        getBaseStats: jest.fn().mockResolvedValue({})\n      };\n      const mockCapacityService = {\n        getBaseCapacities: jest.fn().mockResolvedValue({})\n      };\n\n      jest.doMock('../../../services/bases/StatsService', () => ({\n        StatsService: mockStatsService\n      }));\n      jest.doMock('../../../services/bases/CapacityService', () => ({\n        CapacityService: mockCapacityService\n      }));\n\n      await request(app)\n        .get('/bases/A00:00:01:01/combined-stats')\n        .expect(HTTP_STATUS.OK);\n\n      // Both services should be called with correct parameters\n      expect(mockStatsService.getBaseStats).toHaveBeenCalledWith('empire123', 'A00:00:01:01');\n      expect(mockCapacityService.getBaseCapacities).toHaveBeenCalledWith('empire123', 'A00:00:01:01');\n    });\n  });\n\n  describe('Response Format Compliance (FR-12)', () => {\n    it('should follow established response format for all endpoints', async () => {\n      // Mock minimal data\n      mockSupabase.from.mockReturnValue({\n        select: jest.fn().mockReturnThis(),\n        eq: jest.fn().mockResolvedValue({ data: [], error: null })\n      } as any);\n\n      // Test all endpoints follow the same format\n      const endpoints = [\n        '/bases',\n        '/bases/A00:00:01:01/stats', \n        '/bases/A00:00:01:01/capacities',\n        '/bases/A00:00:01:01/combined-stats'\n      ];\n\n      for (const endpoint of endpoints) {\n        const response = await request(app).get(endpoint);\n        \n        expect(response.body).toHaveProperty('success');\n        expect(typeof response.body.success).toBe('boolean');\n        \n        if (response.body.success) {\n          expect(response.body).toHaveProperty('data');\n        } else {\n          expect(response.body).toHaveProperty('error');\n        }\n      }\n    });\n  });\n\n  describe('Authentication and Empire Resolution (FR-14)', () => {\n    it('should use EmpireResolutionService consistently across all endpoints', async () => {\n      mockSupabase.from.mockReturnValue({\n        select: jest.fn().mockReturnThis(),\n        eq: jest.fn().mockResolvedValue({ data: [], error: null })\n      } as any);\n\n      const endpoints = [\n        '/bases',\n        '/bases/A00:00:01:01/stats',\n        '/bases/A00:00:01:01/capacities', \n        '/bases/A00:00:01:01/combined-stats'\n      ];\n\n      for (const endpoint of endpoints) {\n        jest.clearAllMocks();\n        await request(app).get(endpoint);\n        \n        expect(mockEmpireResolutionService.resolveEmpireByUserObject)\n          .toHaveBeenCalledWith(mockUser);\n      }\n    });\n  });\n});\n\n\n\n\r\n"],"version":3}
{"file":"C:\\Projects\\Attrition\\packages\\server\\src\\utils\\logger.ts","mappings":"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","names":[],"sources":["C:\\Projects\\Attrition\\packages\\server\\src\\utils\\logger.ts"],"sourcesContent":["import { ENV_VARS } from '@game/shared';\n\n// Lightweight logger that respects DEBUG_RESOURCES\r\n// Usage:\r\n//   import { logger } from './utils/logger'\r\n//   logger.info('message', ctx)\r\n//   logger.warn('warn')\r\n//   logger.error('error')\r\n// Namespacing:\r\n//   const log = logger.withNamespace('HybridLoop')\r\n//   log.info('started')\r\n// Console patch (optional):\r\n//   import { initLogger } from './utils/logger'\r\n//   initLogger() // redirects console.info/debug automatically; optionally console.log when DEBUG_PATCH_LOG=true\r\n\r\n/* eslint-disable no-console */\r\n\r\nexport type LogMethod = (...args: any[]) => void\r\n\r\nfunction isInfoEnabled(): boolean {\r\n  return process.env[ENV_VARS.DEBUG_RESOURCES] === 'true'\r\n}\r\n\r\nfunction fmtNs(ns?: string): string {\r\n  return ns ? `[${ns}]` : ''\r\n}\r\n\r\nexport interface ILogger {\r\n  info: LogMethod\r\n  debug: LogMethod\r\n  warn: LogMethod\r\n  error: LogMethod\r\n  withNamespace(ns: string): ILogger\r\n}\r\n\r\nfunction createLogger(ns?: string): ILogger {\r\n  const info: LogMethod = (...args) => {\r\n    if (isInfoEnabled()) console.info(fmtNs(ns), ...args)\r\n  }\r\n  const debug: LogMethod = (...args) => {\r\n    if (isInfoEnabled()) console.debug(fmtNs(ns), ...args)\r\n  }\r\n  const warn: LogMethod = (...args) => console.warn(fmtNs(ns), ...args)\r\n  const error: LogMethod = (...args) => console.error(fmtNs(ns), ...args)\r\n\r\n  return {\r\n    info,\r\n    debug,\r\n    warn,\r\n    error,\r\n    withNamespace(childNs: string) {\r\n      const merged = ns ? `${ns}:${childNs}` : childNs\r\n      return createLogger(merged)\r\n    },\r\n  }\r\n}\r\n\r\nexport const logger = createLogger()\r\n\r\n/**\r\n * initLogger: optionally patch console methods so future logs follow DEBUG_RESOURCES\r\n * - Always redirects console.info/debug to gated versions\r\n * - If DEBUG_PATCH_LOG === 'true', also redirects console.log to gated version\r\n */\r\nexport function initLogger() {\r\n  const gatedInfo: LogMethod = (...args) => {\r\n    if (isInfoEnabled()) (console as any).__orig_info ? (console as any).__orig_info(...args) : console.log(...args)\r\n  }\r\n  const gatedDebug: LogMethod = (...args) => {\r\n    if (isInfoEnabled()) (console as any).__orig_debug ? (console as any).__orig_debug(...args) : console.log(...args)\r\n  }\r\n\r\n  // Preserve original methods to avoid recursion\r\n  ;(console as any).__orig_info = (console as any).__orig_info || console.info.bind(console)\r\n  ;(console as any).__orig_debug = (console as any).__orig_debug || console.debug.bind(console)\r\n  ;(console as any).__orig_log = (console as any).__orig_log || console.log.bind(console)\r\n\r\n  // Patch info/debug unconditionally to respect DEBUG_RESOURCES\r\n  console.info = gatedInfo as any\r\n  console.debug = gatedDebug as any\r\n\r\n  // Optional: also gate console.log if explicitly requested (safer opt-in)\r\n  if (process.env[ENV_VARS.DEBUG_PATCH_LOG] === 'true') {\r\n    const gatedLog: LogMethod = (...args) => {\r\n      if (isInfoEnabled()) (console as any).__orig_log(...args)\r\n    }\r\n    console.log = gatedLog as any\r\n  }\r\n}\r\n"],"version":3}